<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <meta name="google-site-verification" content="SFq3YDKWo-0iRrNXCwYND3ygW9ThJJUQaK1zTMiqf44">
  
  <!-- Dynamic SEO Meta Tags - Admin Controlled -->
  <meta name="description" id="metaDescription" content="প্রিমিয়াম কোয়ালিটির ফরমাল, ক্যাজুয়াল ও প্রিমিয়াম শার্ট সেরা দামে। AMAYRA তে অর্ডার করুন দ্রুত ডেলিভারি পাবেন।">
  <meta name="keywords" id="metaKeywords" content="শার্ট, ফরমাল শার্ট, ক্যাজুয়াল শার্ট, প্রিমিয়াম শার্ট, পাঞ্জাবি, ঢাকা, বাংলাদেশ, AMAYRA">
  <meta name="author" id="metaAuthor" content="AMAYRA">
  <title id="metaTitle">AMAYRA · প্রিমিয়াম শার্ট কালেকশন</title>
  
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" id="ogTitle" content="AMAYRA · প্রিমিয়াম শার্ট কালেকশন">
  <meta property="og:description" id="ogDescription" content="প্রিমিয়াম কোয়ালিটির ফরমাল, ক্যাজুয়াল ও প্রিমিয়াম শার্ট সেরা দামে।">
  <meta property="og:image" id="ogImage" content="images/Amayra.jpg">
  <meta property="og:url" content="https://amayra.online">
  <meta property="og:type" content="website">

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="icon" href="images/amayra.png" type="image/png">
  
 <style>
  /* Your existing styles remain exactly the same */
* { margin: 0; padding: 0; box-sizing: border-box; }
body { 
  background: #FFFFFF;
  font-family: 'Hind Siliguri', sans-serif;
  color: #1C1E21;
}
.brand-logo {
  display: flex;
  align-items: center;
  gap: 12px;
  animation: pulse-slow 3s infinite ease-in-out;
  cursor: pointer;
  text-decoration: none;
  color: inherit;
}
.brand-logo:hover {
  animation: none;
}
.brand-logo img {
  max-height: 55px;
  width: auto;
  display: block;
  border-radius: 16px;
  box-shadow: 0 4px 8px rgba(24, 119, 242, 0.2);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.brand-logo img:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 16px rgba(24, 119, 242, 0.3);
}
.brand-text {
  display: flex;
  flex-direction: column;
  line-height: 1.2;
}
.brand-elegant {
  font-family: 'Playfair Display', serif;
  font-weight: 900;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: #1C1E21;
  font-size: 1.8rem;
  transition: color 0.3s ease;
}
.brand-elegant:hover {
  color: #1877F2;
}
.brand-subtitle {
  font-family: 'Hind Siliguri', sans-serif;
  font-size: 0.7rem;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: #1877F2;
  margin-top: -2px;
  font-weight: 500;
}

@keyframes pulse-slow {
  0% { transform: scale(1); }
  50% { transform: scale(1.02); }
  100% { transform: scale(1); }
}

.glass-card {
  background: rgba(255, 255, 255, 0.75);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border: 1px solid rgba(255, 255, 255, 0.5);
  border-radius: 2rem 1rem 2rem 1rem;
  box-shadow: 0 20px 40px -12px rgba(0, 0, 0, 0.1);
}

.btn-primary {
  background: #1877F2;
  color: white;
  transition: all 0.2s;
  box-shadow: 0 6px 14px rgba(24, 119, 242, 0.3);
  border-radius: 40px 12px 40px 12px;
  font-weight: 600;
  letter-spacing: 0.3px;
}
.btn-primary:hover {
  background: #1666d9;
  transform: scale(1.02) translateY(-2px);
  box-shadow: 0 12px 20px -8px #1877F2;
}

.btn-cta {
  background: #FF7A00;
  color: white;
  transition: all 0.2s;
  box-shadow: 0 6px 14px rgba(255, 122, 0, 0.3);
  border-radius: 40px 12px 40px 12px;
  font-weight: 600;
  letter-spacing: 0.3px;
}
.btn-cta:hover {
  background: #e66e00;
  transform: scale(1.02) translateY(-2px);
  box-shadow: 0 12px 20px -8px #FF7A00;
}

.btn-secondary {
  background: #F0F2F5;
  color: #1C1E21;
  border-radius: 40px 12px 40px 12px;
  font-weight: 600;
  transition: 0.2s;
}
.btn-secondary:hover { background: #e2e4e8; }

.product-tile {
  background: white;
  border-radius: 3rem 1.2rem 3rem 1.2rem;
  transition: 0.35s cubic-bezier(0.2, 0.9, 0.3, 1.1);
  border: 1px solid #F0F2F5;
  box-shadow: 0 10px 25px -10px rgba(24, 119, 242, 0.1);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}
.product-tile:hover {
  border-radius: 1.5rem 3rem 1.5rem 3rem;
  box-shadow: 0 25px 35px -14px rgba(24, 119, 242, 0.2);
}

/* Updated product gallery for mobile */
.product-gallery {
  position: relative;
  width: 100%;
  margin-bottom: 0.5rem;
}

.main-image {
  width: 100%;
  height: auto;
  min-height: 250px;
  max-height: 350px;
  object-fit: cover;
  border-radius: 30px 8px 30px 8px;
  cursor: pointer;
  transition: transform 0.3s;
}

@media (min-width: 768px) {
  .main-image {
    min-height: 200px;
    max-height: 300px;
  }
}

.main-image:hover {
  transform: scale(1.02);
}

.thumbnail-container {
  display: flex;
  gap: 0.5rem;
  margin-top: 0.75rem;
  overflow-x: auto;
  padding-bottom: 0.5rem;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: thin;
}

.thumbnail-container img {
  width: 70px;
  height: 70px;
  border-radius: 15px 4px 15px 4px;
  object-fit: cover;
  cursor: pointer;
  border: 2px solid transparent;
  transition: all 0.2s;
  flex-shrink: 0;
}

@media (max-width: 480px) {
  .thumbnail-container img {
    width: 60px;
    height: 60px;
  }
}

.thumbnail-container img:hover {
  border-color: #1877F2;
  transform: scale(1.05);
}

.thumbnail-container img.active {
  border-color: #1877F2;
  transform: scale(1.05);
}

.fullscreen-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.95);
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s;
}
.fullscreen-modal.active {
  opacity: 1;
  visibility: visible;
}
.fullscreen-modal img {
  max-width: 95%;
  max-height: 90%;
  object-fit: contain;
  border-radius: 20px;
}
.fullscreen-close {
  position: absolute;
  top: 20px;
  right: 20px;
  color: white;
  font-size: 2rem;
  cursor: pointer;
  width: 50px;
  height: 50px;
  background: rgba(255,255,255,0.1);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}
.fullscreen-close:hover {
  background: rgba(255,255,255,0.2);
  transform: rotate(90deg);
}
.fullscreen-prev, .fullscreen-next {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  color: white;
  font-size: 2rem;
  cursor: pointer;
  padding: 1rem;
  background: rgba(255,255,255,0.1);
  border-radius: 50%;
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}

@media (max-width: 768px) {
  .fullscreen-prev, .fullscreen-next {
    width: 40px;
    height: 40px;
    font-size: 1.5rem;
  }
}

.fullscreen-prev:hover, .fullscreen-next:hover {
  background: #1877F2;
}
.fullscreen-prev { left: 10px; }
.fullscreen-next { right: 10px; }

@media (max-width: 480px) {
  .fullscreen-prev { left: 5px; }
  .fullscreen-next { right: 5px; }
}

.morph-header {
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(16px);
  border-bottom: 1px solid rgba(24, 119, 242, 0.2);
  position: sticky;
  top: 0;
  z-index: 40;
  width: 100%;
}

.dropdown-sidebar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: #FFFFFF;
  backdrop-filter: blur(12px);
  border-bottom: 2px solid #1877F2;
  box-shadow: 0 20px 30px -10px rgba(0,0,0,0.2);
  z-index: 999;
  display: none;
  padding: 1.5rem 2rem;
  border-bottom-left-radius: 40px 20px;
  border-bottom-right-radius: 40px 20px;
}
.dropdown-sidebar.open { display: block; }

.dropdown-overlay {
  position: fixed;
  inset: 0;
  background: rgba(24, 119, 242, 0.1);
  backdrop-filter: blur(2px);
  z-index: 998;
  display: none;
}
.dropdown-overlay.open { display: block; }

.cat-pill {
  background: #F0F2F5;
  padding: 0.5rem 1.8rem;
  border-radius: 60px 12px 60px 12px;
  font-weight: 500;
  color: #1C1E21;
  cursor: pointer;
  transition: 0.2s;
  border: 1px solid transparent;
  white-space: nowrap;
}
.cat-pill.active {
  background: #1877F2;
  color: white;
  border-color: #1877F2;
  box-shadow: 0 8px 14px rgba(24, 119, 242, 0.3);
}

.gallery-thumb {
  width: 50px;
  height: 50px;
  border-radius: 12px;
  object-fit: cover;
  border: 2px solid white;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  cursor: pointer;
  transition: all 0.2s;
}
.gallery-thumb.active {
  border-color: #1877F2;
  transform: scale(1.05);
  box-shadow: 0 6px 12px rgba(24, 119, 242, 0.3);
}

/* ===== হিরো স্লাইডার আপডেটেড স্টাইল ===== */

.hero-slide {
  border-radius: 50px 20px 50px 20px;
  overflow: hidden;
  box-shadow: 0 30px 30px -20px rgba(24, 119, 242, 0.2);
  position: relative;
}

.hero-slide .slide-bg {
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  min-height: 280px;
  position: relative;
}

/* ইমেজের উপরে হাল্কা গ্রেডিয়েন্ট ওভারলে */
.hero-slide .slide-bg::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0.15) 100%);
  z-index: 1;
}

@media (min-width: 768px) {
  .hero-slide .slide-bg {
    min-height: 450px;
  }
}

/* স্লাইডার কন্টেন্ট কন্টেইনার - ব্লার ব্যাকগ্রাউন্ড সহ */
.hero-slide .slide-content {
  position: relative;
  z-index: 2;
  background: rgba(10, 25, 47, 0.4);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border-radius: 60px 20px 60px 20px;
  padding: 2rem 2.5rem;
  border: 1px solid rgba(255, 255, 255, 0.15);
  max-width: 550px;
  margin: 2rem;
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
  animation: slideContentFade 0.5s ease-out;
}

@keyframes slideContentFade {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* স্লাইডার টেক্সট স্টাইল */
.hero-slide .slide-content span {
  display: inline-block;
  font-weight: 600;
  letter-spacing: 0.5px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

.hero-slide .slide-content h2 {
  font-size: 2.8rem;
  font-weight: 800;
  line-height: 1.2;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
  margin-bottom: 0.5rem;
}

.hero-slide .slide-content p {
  font-size: 1.2rem;
  margin-bottom: 1.5rem;
  opacity: 0.95;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
}

/* স্লাইডার নেভিগেশন বাটন - ডিফল্ট অবস্থায় হাইড */
.slide-nav-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(255, 255, 255, 0.9);
  width: 48px;
  height: 48px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
  opacity: 0;
  transition: opacity 0.3s ease, transform 0.2s ease, background 0.3s;
  border: 2px solid white;
  color: #1877F2;
  font-size: 1.4rem;
  z-index: 10;
}

/* হোভার করলে বাটন দেখাবে */
.hero-slide:hover .slide-nav-btn {
  opacity: 1;
}

.slide-nav-left {
  left: 20px;
}

.slide-nav-right {
  right: 20px;
}

/* বাটন হোভার ইফেক্ট */
.slide-nav-btn:hover {
  background: #1877F2;
  color: white;
  transform: translateY(-50%) scale(1.15);
  box-shadow: 0 10px 25px rgba(24, 119, 242, 0.5);
  border-color: #1877F2;
}

/* মোবাইল ডিভাইসের জন্য স্পেশাল স্টাইল */
@media (max-width: 768px) {
  .hero-slide .slide-content {
    padding: 1.2rem 1.5rem;
    margin: 1rem;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    background: rgba(10, 25, 47, 0.5);
    max-width: 100%;
  }
  
  .hero-slide .slide-content h2 {
    font-size: 1.8rem;
    line-height: 1.3;
    margin-bottom: 0.25rem;
  }
  
  .hero-slide .slide-content p {
    font-size: 1rem;
    margin-bottom: 1rem;
  }
  
  .hero-slide .slide-content .btn-cta {
    padding: 0.5rem 1.2rem;
    font-size: 0.95rem;
  }
  
  .slide-nav-btn {
    width: 38px;
    height: 38px;
    font-size: 1.1rem;
    opacity: 0;
    background: rgba(255, 255, 255, 0.95);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.25);
  }
  
  /* মোবাইলে হোভার করলে বাটন দেখাবে */
  .hero-slide:hover .slide-nav-btn {
    opacity: 1;
  }
  
  .slide-nav-left {
    left: 10px;
  }
  
  .slide-nav-right {
    right: 10px;
  }
}

/* টাচ স্ক্রিন ডিভাইসের জন্য স্পেশাল স্টাইল */
@media (hover: none) and (pointer: coarse) {
  .slide-nav-btn {
    opacity: 0.7;
    background: rgba(255, 255, 255, 0.9);
  }
  
  .hero-slide:active .slide-nav-btn {
    opacity: 1;
  }
  
  .slide-nav-btn:active {
    background: #1877F2;
    color: white;
    transform: translateY(-50%) scale(1.1);
  }
}

/* খুব ছোট স্ক্রিনের জন্য */
@media (max-width: 480px) {
  .hero-slide .slide-content {
    padding: 1rem;
    margin: 0.75rem;
  }
  
  .hero-slide .slide-content h2 {
    font-size: 1.5rem;
  }
  
  .hero-slide .slide-content p {
    font-size: 0.9rem;
    margin-bottom: 0.75rem;
  }
  
  .slide-nav-btn {
    width: 34px;
    height: 34px;
    font-size: 1rem;
  }
  
  .slide-nav-left {
    left: 5px;
  }
  
  .slide-nav-right {
    right: 5px;
  }
}

/* স্লাইডার ডটস স্টাইল */
#sliderDots {
  display: flex;
  gap: 10px;
  padding: 8px 12px;
  background: rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  border-radius: 30px;
  bottom: 15px;
}

#sliderDots span {
  width: 8px;
  height: 8px;
  transition: all 0.3s ease;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

#sliderDots span:hover {
  transform: scale(1.3);
  background: #1877F2 !important;
}

/* ===== স্লাইডার স্টাইল শেষ ===== */

.morph-header {
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(16px);
  border-bottom: 1px solid rgba(24, 119, 242, 0.2);
  position: sticky;
  top: 0;
  z-index: 40;
  width: 100%;
}

.img-loading-spinner {
  position: absolute;
  inset: 0;
  background: rgba(240, 242, 245, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 5;
  backdrop-filter: blur(2px);
  border-radius: 40px 4px 40px 4px;
}
.img-loading-spinner.hidden { display: none; }

.cart-item-new {
  background: #F0F2F5;
  border-radius: 30px 8px 30px 8px;
  padding: 0.8rem 1rem;
  margin-bottom: 0.6rem;
  border-left: 5px solid #1877F2;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 1rem;
}
.cart-item-new.highlight {
  animation: highlight-pulse 1s ease;
  border-left-color: #FF7A00;
  background: #fff3e0;
}
.cart-item-image {
  width: 50px;
  height: 50px;
  border-radius: 15px 4px 15px 4px;
  object-fit: cover;
  border: 2px solid white;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

@keyframes highlight-pulse {
  0% { transform: scale(1); background-color: #fff3e0; }
  50% { transform: scale(1.02); background-color: #ffe4b5; }
  100% { transform: scale(1); background-color: #fff3e0; }
}

.star-organic i { 
  font-size: 2.2rem; 
  margin-right: 8px; 
  color: #ddd; 
  cursor: pointer; 
  transition: all 0.2s; 
  text-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.star-organic i.fa-solid { 
  color: #FF7A00; 
  text-shadow: 0 2px 8px rgba(255, 122, 0, 0.4);
}
.star-organic i:hover { 
  transform: scale(1.2); 
  color: #FF7A00;
}

.reviews-scroll::-webkit-scrollbar {
  width: 3px;
  height: 3px;
}

.reviews-scroll::-webkit-scrollbar-track {
  background: #F0F2F5;
  border-radius: 0;
}

.reviews-scroll::-webkit-scrollbar-thumb {
  background: #1877F2;
  border-radius: 0;
}

.reviews-scroll::-webkit-scrollbar-thumb:hover {
  background: #1666d9;
}

.reviews-scroll {
  scrollbar-width: thin;
  scrollbar-color: #1877F2 #F0F2F5;
}

.order-section-wrapper {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.5rem;
  align-items: stretch;
}

@media (min-width: 992px) {
  .order-section-wrapper {
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
  }
}

#orderFormCard,
.bestseller-slider {
  height: fit-content;
  min-height: 700px;
  display: flex;
  flex-direction: column;
}

.bestseller-slider {
  background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
  border-radius: 40px 12px 40px 12px;
  padding: 2rem;
  border: 2px solid rgba(24, 119, 242, 0.15);
  box-shadow: 0 15px 30px -10px rgba(0,0,0,0.1);
  position: relative;
  overflow: hidden;
  display: none;
}

@media (min-width: 992px) {
  .bestseller-slider {
    display: flex;
  }
}

.bestseller-slider::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 5px;
  background: linear-gradient(90deg, #1877F2, #FF7A00, #1877F2);
  background-size: 200% 100%;
  animation: gradientMove 3s linear infinite;
}

@keyframes gradientMove {
  0% { background-position: 0% 0%; }
  100% { background-position: 200% 0%; }
}

.bestseller-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 2rem;
  padding-bottom: 1rem;
  border-bottom: 2px dashed rgba(24, 119, 242, 0.2);
}

.bestseller-header i {
  font-size: 2.5rem;
  color: #FF7A00;
  filter: drop-shadow(0 4px 6px rgba(255,122,0,0.3));
  animation: flame 2s ease-in-out infinite;
}

@keyframes flame {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.bestseller-header h3 {
  font-size: 1.8rem;
  font-weight: 700;
  background: linear-gradient(135deg, #1877F2, #FF7A00);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

#bestsellerContainer {
  flex: 1;
  display: flex;
  flex-direction: column;
}

.bestseller-item {
  background: white;
  border-radius: 30px 8px 30px 8px;
  padding: 1.5rem;
  margin-bottom: 1rem;
  border: 1px solid rgba(24, 119, 242, 0.1);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.bestseller-item::after {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 100%;
  height: 200%;
  background: linear-gradient(45deg, transparent, rgba(24, 119, 242, 0.03), transparent);
  transform: rotate(45deg);
  transition: transform 0.6s;
}

.bestseller-item:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 20px 30px -10px rgba(24, 119, 242, 0.25);
  border-color: #1877F2;
}

.bestseller-item:hover::after {
  transform: rotate(45deg) translate(50%, 50%);
}

.bestseller-item .product-section {
  display: flex;
  flex-direction: row;
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.bestseller-item img {
  width: 100px;
  height: 100px;
  border-radius: 25px 6px 25px 6px;
  object-fit: cover;
  border: 3px solid white;
  box-shadow: 0 8px 15px -5px rgba(0,0,0,0.2);
  transition: transform 0.3s;
}

.bestseller-item:hover img {
  transform: scale(1.05);
}

.bestseller-info {
  flex: 1;
}

.bestseller-info h4 {
  font-size: 1.3rem;
  font-weight: 700;
  color: #1C1E21;
  margin-bottom: 0.3rem;
}

.bestseller-price {
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 0.5rem 0;
}

.bestseller-price .current {
  font-size: 1.6rem;
  font-weight: 800;
  color: #FF7A00;
}

.bestseller-price .original {
  font-size: 1.1rem;
  color: #a0aec0;
  text-decoration: line-through;
}

.bestseller-discount {
  background: linear-gradient(135deg, #FF7A00, #ff9a3c);
  color: white;
  padding: 0.3rem 1rem;
  border-radius: 20px 4px 20px 4px;
  font-size: 0.9rem;
  font-weight: 600;
  display: inline-block;
  margin-bottom: 1rem;
}

.bestseller-reviews {
  margin: 1rem 0;
  padding: 0.5rem 0;
  border-top: 1px dashed rgba(24, 119, 242, 0.2);
  border-bottom: 1px dashed rgba(24, 119, 242, 0.2);
}

.bestseller-review-item {
  background: #F8FAFC;
  border-radius: 20px 4px 20px 4px;
  padding: 0.8rem;
  margin-bottom: 0.8rem;
  border-left: 3px solid #FF7A00;
  animation: slideInReview 0.5s ease-out;
  position: relative;
  overflow: hidden;
}

.bestseller-review-item:last-child {
  margin-bottom: 0;
}

.bestseller-review-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(45deg, transparent, rgba(255, 122, 0, 0.05), transparent);
  transform: translateX(-100%);
  animation: shimmerReview 2s infinite;
}

@keyframes slideInReview {
  0% {
    opacity: 0;
    transform: translateX(-20px);
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes shimmerReview {
  0% {
    transform: translateX(-100%);
  }
  50% {
    transform: translateX(100%);
  }
  100% {
    transform: translateX(200%);
  }
}

.bestseller-review-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.3rem;
}

.bestseller-review-name {
  font-weight: 600;
  color: #1C1E21;
  font-size: 0.9rem;
}

.bestseller-review-rating {
  color: #FF7A00;
  font-size: 0.8rem;
}

.bestseller-review-text {
  font-size: 0.85rem;
  color: #4a5568;
  line-height: 1.4;
  margin: 0.2rem 0;
}

.bestseller-review-location {
  font-size: 0.7rem;
  color: #1877F2;
  display: flex;
  align-items: center;
  gap: 3px;
  margin-top: 0.2rem;
}

.bestseller-review-location i {
  font-size: 0.6rem;
}

.bestseller-btn {
  background: linear-gradient(135deg, #1877F2, #1666d9);
  color: white;
  border: none;
  border-radius: 30px 6px 30px 6px;
  padding: 0.8rem 1.5rem;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  width: 100%;
  margin-top: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.bestseller-btn:hover {
  background: linear-gradient(135deg, #1666d9, #0a5bc4);
  transform: translateY(-2px);
  box-shadow: 0 10px 20px -5px #1877F2;
}

.bestseller-btn i {
  font-size: 1rem;
}

.bestseller-nav {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1.5rem;
  margin-top: 2rem;
  padding-top: 1rem;
  border-top: 1px solid rgba(24, 119, 242, 0.1);
}

.bestseller-nav button {
  width: 45px;
  height: 45px;
  border-radius: 50%;
  background: white;
  border: 2px solid #e2e8f0;
  cursor: pointer;
  transition: all 0.3s;
  color: #1877F2;
  font-size: 1.2rem;
  display: flex;
  align-items: center;
  justify-content: center;
}

.bestseller-nav button:hover {
  background: #1877F2;
  color: white;
  border-color: #1877F2;
  transform: scale(1.1);
}

.bestseller-nav span {
  font-size: 1.1rem;
  font-weight: 600;
  color: #4a5568;
  background: #f0f2f5;
  padding: 0.5rem 1.5rem;
  border-radius: 30px;
}

.review-section-wrapper {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.5rem;
}

@media (min-width: 768px) {
  .review-section-wrapper {
    grid-template-columns: 1fr 1fr;
  }
}

.review-form-card, .reviews-card {
  height: 500px;
  display: flex;
  flex-direction: column;
}

.reviews-card {
  overflow-y: auto;
}

.review-form-card {
  overflow-y: auto;
}

.call-button {
  background: linear-gradient(135deg, #FF7A00, #ff9a3c);
  color: white;
  padding: 0.6rem 1.5rem;
  border-radius: 40px 12px 40px 12px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  transition: all 0.3s;
  box-shadow: 0 4px 15px rgba(255,122,0,0.3);
}

.call-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(255,122,0,0.4);
  background: linear-gradient(135deg, #e66e00, #ff8a2b);
}

.container-1200 {
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
  width: 100%;
  padding-left: 1rem;
  padding-right: 1rem;
}

.header-container {
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
  width: 100%;
  padding-left: 1rem;
  padding-right: 1rem;
}

.product-grid-1200 {
  display: grid;
  grid-template-columns: repeat(1, 1fr);
  gap: 1.75rem;
}

@media (min-width: 640px) {
  .product-grid-1200 {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (min-width: 1024px) {
  .product-grid-1200 {
    grid-template-columns: repeat(4, 1fr);
  }
}

.whatsapp-float {
  position: fixed;
  bottom: 25px;
  right: 25px;
  background-color: #25D366;
  color: white;
  width: 65px;
  height: 65px;
  border-radius: 50%;
  text-align: center;
  font-size: 35px;
  box-shadow: 0 10px 25px rgba(37, 211, 102, 0.4);
  z-index: 100;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
  border: 3px solid white;
  animation: pulse-green 2s infinite;
}
.whatsapp-float:hover {
  transform: scale(1.15) rotate(5deg);
  background-color: #20b859;
  box-shadow: 0 15px 30px rgba(37, 211, 102, 0.6);
  animation: none;
}

@keyframes pulse-green {
  0% { box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.7); }
  70% { box-shadow: 0 0 0 15px rgba(37, 211, 102, 0); }
  100% { box-shadow: 0 0 0 0 rgba(37, 211, 102, 0); }
}

.footer-custom {
  background: #0A192F;
  width: 100%;
}
.footer-text {
  color: #E6EDF3;
}

.loading-spinner {
  display: inline-block;
  width: 40px;
  height: 40px;
  border: 3px solid #f3f3f3;
  border-top: 3px solid #1877F2;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.sold-out {
  position: absolute;
  top: 10px;
  left: 10px;
  background: #dc2626;
  color: white;
  padding: 0.25rem 1rem;
  border-radius: 20px 4px 20px 4px;
  font-size: 0.8rem;
  font-weight: 600;
  z-index: 10;
}

.hamburger {
  width: 32px;
  height: 32px;
  display: flex;
  flex-direction: column;
  justify-content: space-around;
  padding: 6px 0;
  cursor: pointer;
  transition: transform 0.3s ease;
  z-index: 1000;
  background: transparent;
  border: none;
}

.hamburger span {
  display: block;
  width: 100%;
  height: 3px;
  background: #1877F2;
  border-radius: 3px;
  transition: all 0.3s ease;
}

.hamburger span:nth-child(2) {
  width: 70%;
}

.hamburger.open span:nth-child(1) {
  transform: translateY(8px) rotate(45deg);
  width: 100%;
}

.hamburger.open span:nth-child(2) {
  opacity: 0;
  width: 100%;
}

.hamburger.open span:nth-child(3) {
  transform: translateY(-8px) rotate(-45deg);
  width: 100%;
}

body.menu-open {
  overflow: hidden;
}

.close-menu-btn {
  background: none;
  border: none;
  font-size: 2rem;
  cursor: pointer;
  color: #1C1E21;
  transition: 0.2s;
}
.close-menu-btn:hover {
  color: #1877F2;
  transform: rotate(90deg);
}

@media (max-width: 768px) {
  .hamburger {
    width: 28px;
    height: 28px;
    padding: 5px 0;
  }
  
  .hamburger span {
    height: 2.5px;
  }
  
  .hamburger.open span:nth-child(1) {
    transform: translateY(7px) rotate(45deg);
  }
  
  .hamburger.open span:nth-child(3) {
    transform: translateY(-7px) rotate(-45deg);
  }
}
 </style>
</head>
<body class="text-[#1C1E21]">

<div class="dropdown-sidebar" id="dropdownSidebar">
  <div class="flex justify-between items-center mb-6">
    <a href="#home" class="brand-logo">
      <img src="images/Amayra.jpg" alt="AMAYRA Logo">
      <div class="brand-text">
        <div class="brand-elegant" id="sidebarBrandName">AMAYRA</div>
        <div class="brand-subtitle" id="sidebarBrandSubtitle">LUXURY CLOTHING BRAND</div>
      </div>
    </a>
    <button class="close-menu-btn" id="closeMenuBtn" aria-label="Close menu">
      <i class="fa-regular fa-circle-xmark"></i>
    </button>
  </div>
  <div class="grid grid-cols-2 gap-4 text-center">
    <a href="#home" class="menu-link btn-secondary py-3 px-2 hover:scale-105 transition"><i class="fa-regular fa-compass mr-2 text-[#1877F2]"></i>হোম</a>
    <a href="#collection" class="menu-link btn-secondary py-3 px-2 hover:scale-105 transition"><i class="fa-regular fa-star mr-2 text-[#1877F2]"></i>সংকলন</a>
    <a href="#order" class="menu-link btn-secondary py-3 px-2 hover:scale-105 transition"><i class="fa-regular fa-clipboard mr-2 text-[#1877F2]"></i>অর্ডার</a>
    <a href="#reviews" class="menu-link btn-secondary py-3 px-2 hover:scale-105 transition"><i class="fa-regular fa-message mr-2 text-[#1877F2]"></i>রিভিউ</a>
  </div>
  <div class="mt-6 flex gap-3">
    <a href="tel:+8801712345678" class="btn-cta flex-1 text-center py-3 hover:shadow-xl" id="sidebarPhone"><i class="fa-solid fa-phone mr-2"></i>কল করুন</a>
  </div>
</div>
<div class="dropdown-overlay" id="dropdownOverlay"></div>

<header class="morph-header py-3">
  <div class="header-container flex justify-between items-center">
    <a href="#home" class="brand-logo">
      <img src="images/Amayra.jpg" alt="AMAYRA Logo">
      <div class="brand-text">
        <div class="brand-elegant text-3xl md:text-4xl" id="headerBrandName">AMAYRA</div>
        <div class="brand-subtitle" id="headerBrandSubtitle">PREMIUM SHIRT COLLECTION</div>
      </div>
    </a>
    
    <nav class="hidden md:flex gap-8 text-[#1C1E21] font-medium">
      <a href="#home" class="hover:text-[#1877F2] border-b-2 border-transparent hover:border-[#1877F2] transition">হোম</a>
      <a href="#collection" class="hover:text-[#1877F2] border-b-2 border-transparent hover:border-[#1877F2] transition">সংকলন</a>
      <a href="#order" class="hover:text-[#1877F2] border-b-2 border-transparent hover:border-[#1877F2] transition">অর্ডার</a>
      <a href="#reviews" class="hover:text-[#1877F2] border-b-2 border-transparent hover:border-[#1877F2] transition">রিভিউ</a>
    </nav>
    
    <div class="flex items-center gap-4">
      <a href="tel:+8801712345678" class="hidden md:flex call-button" id="headerPhone">
        <i class="fa-solid fa-phone"></i>
        <span>কল করুন</span>
      </a>
      <div class="hamburger md:hidden" id="hamburgerBtn">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>
</header>

<section id="home" class="pt-6 pb-4 px-4 container-1200">
  <div class="relative hero-slide">
    <div class="flex transition-transform duration-500 ease-out" id="sliderTrack"></div>
    <button class="slide-nav-btn slide-nav-left" onclick="slideChange(-1)" aria-label="Previous slide"><i class="fa-solid fa-chevron-left"></i></button>
    <button class="slide-nav-btn slide-nav-right" onclick="slideChange(1)" aria-label="Next slide"><i class="fa-solid fa-chevron-right"></i></button>
    <div class="absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-3" id="sliderDots"></div>
  </div>
</section>

<!-- collection section with hash fragments for each category -->
<section id="collection" class="container-1200 px-4 py-10">
  <div class="text-center">
    <h2 class="text-4xl font-bold text-[#1C1E21]">আমাদের <span class="text-[#1877F2]" id="collectionTitle">সংকলন</span></h2>
    <p class="text-[#1C1E21] opacity-70" id="collectionSubtitle">প্রিমিয়াম কোয়ালিটির শার্ট সেরা দামে</p>
  </div>
  
  <div class="flex flex-wrap justify-center gap-3 my-8" id="categoryPills">
    <a href="#collection-all" class="cat-pill active" onclick="filterProducts('all', this); return false;">সকল</a>
    <a href="#collection-formal" class="cat-pill" onclick="filterProducts('formal', this); return false;">ফরমাল</a>
    <a href="#collection-casual" class="cat-pill" onclick="filterProducts('casual', this); return false;">ক্যাজুয়াল</a>
    <a href="#collection-premium" class="cat-pill" onclick="filterProducts('premium', this); return false;">প্রিমিয়াম</a>
  </div>

  <div id="productGrid" class="product-grid-1200">
    <div class="col-span-full text-center py-10">
      <div class="loading-spinner"></div>
      <p class="mt-4 text-gray-600">প্রোডাক্ট লোড হচ্ছে...</p>
    </div>
  </div>
</section>

<section id="order" class="container-1200 px-4 py-10">
  <div class="order-section-wrapper">
    <div class="glass-card p-6 md:p-8 border-t-4 border-t-[#1877F2]" id="orderFormCard">
      <h2 class="text-3xl font-bold flex items-center gap-3"><i class="fa-regular fa-pen-to-square text-[#1877F2]"></i> অর্ডার <span class="text-[#1877F2]">ফর্ম</span></h2>
      <div class="bg-[#F0F2F5]/90 rounded-[30px_8px_30px_8px] p-5 my-5">
        <div id="cartItems" class="space-y-2 max-h-64 overflow-auto reviews-scroll pr-2"></div>
        <div class="flex justify-between items-center mt-4 pt-3 border-t border-[#1C1E21]/20 text-2xl font-bold">
          <span>সাবটোটাল:</span>
          <span id="subtotal" class="text-[#1C1E21]">৳০</span>
        </div>
        <div class="flex justify-between items-center mt-2 text-lg">
          <span>ডেলিভারি চার্জ:</span>
          <span id="deliveryCharge" class="text-[#FF7A00]">৳০</span>
        </div>
        <div class="flex justify-between items-center mt-2 pt-2 border-t border-dashed border-[#1C1E21]/20 text-2xl font-bold">
          <span>মোট:</span>
          <span id="total" class="text-[#FF7A00]">৳০</span>
        </div>
        <p class="text-xs text-[#1C1E21]/70 mt-2 bg-white p-2 rounded-[20px_4px_20px_4px]" id="deliveryNote">
          <i class="fa-solid fa-truck text-[#1877F2] mr-1"></i> ঢাকার মধ্যে ৬০ টাকা, বাইরে ১২০ টাকা। ২০০০ টাকার বেশি অর্ডারে ডেলিভারি ফ্রি!
        </p>
      </div>

      <form id="orderForm" class="grid grid-cols-1 md:grid-cols-2 gap-5">
        <input type="text" id="name" placeholder="আপনার নাম *" required class="p-4 rounded-[40px_6px_40px_6px] border border-[#F0F2F5] bg-white focus:outline-none focus:border-[#1877F2] transition">
        <input type="tel" id="phone" placeholder="মোবাইল *" required class="p-4 rounded-[40px_6px_40px_6px] border border-[#F0F2F5] bg-white focus:outline-none focus:border-[#1877F2] transition">
        
        <select id="district" required class="md:col-span-2 p-4 rounded-[40px_6px_40px_6px] border border-[#F0F2F5] bg-white focus:outline-none focus:border-[#1877F2] transition">
          <option value="" disabled selected>আপনার জেলা নির্বাচন করুন *</option>
          <option value="dhaka">ঢাকা (ভেতরে)</option>
          <option value="outside">ঢাকার বাইরে</option>
        </select>

        <textarea id="address" placeholder="বিস্তারিত ঠিকানা *" rows="2" required class="md:col-span-2 p-4 rounded-[40px_6px_40px_6px] border border-[#F0F2F5] bg-white focus:outline-none focus:border-[#1877F2] transition"></textarea>
        
        <button type="submit" class="btn-cta md:col-span-2 py-4 text-xl hover:shadow-2xl">অর্ডার কনফার্ম করুন</button>
      </form>
    </div>

    <div class="desktop-only bestseller-slider">
      <div class="bestseller-header">
        <i class="fas fa-fire"></i>
        <h3>সর্বাধিক বিক্রিত</h3>
      </div>
      <div id="bestsellerContainer" class="space-y-4">
        <div class="text-center py-8">
          <div class="loading-spinner mx-auto"></div>
        </div>
      </div>
      <div class="bestseller-nav" id="bestsellerNav"></div>
    </div>
  </div>
</section>

<section id="reviews" class="container-1200 px-4 py-10">
  <div class="review-section-wrapper">
    <div class="bg-[#F0F2F5] p-8 rounded-[70px_20px_70px_20px] review-form-card">
      <h3 class="text-2xl font-bold mb-4">আপনার <span class="text-[#1877F2]">মতামত</span> দিন</h3>
      <form id="reviewForm">
        <input type="text" id="reviewName" placeholder="আপনার নাম *" required class="w-full p-3 rounded-[30px_4px_30px_4px] mb-3 border border-[#FFFFFF] bg-white focus:outline-none focus:border-[#1877F2]">
        
        <input type="text" id="reviewAddress" placeholder="আপনার জেলা *" required class="w-full p-3 rounded-[30px_4px_30px_4px] mb-3 border border-[#FFFFFF] bg-white focus:outline-none focus:border-[#1877F2]">
        
        <textarea id="reviewText" placeholder="আপনার রিভিউ *" rows="3" required class="w-full p-3 rounded-[30px_4px_30px_4px] mb-3 border border-[#FFFFFF] bg-white focus:outline-none focus:border-[#1877F2]"></textarea>
        
        <div class="mb-2">
          <span class="rating-label">আপনার রেটিং <span>দিন</span> <i class="fa-regular fa-star text-[#FF7A00] ml-1"></i></span>
        </div>
        <div class="star-organic mb-4" id="starRating">
          <i class="fa-regular fa-star" data-rate="1"></i>
          <i class="fa-regular fa-star" data-rate="2"></i>
          <i class="fa-regular fa-star" data-rate="3"></i>
          <i class="fa-regular fa-star" data-rate="4"></i>
          <i class="fa-regular fa-star" data-rate="5"></i>
        </div>
        <input type="hidden" id="rating" value="0">
        
        <button type="submit" class="btn-primary w-full py-3 text-lg hover:shadow-xl">রিভিউ জমা দিন</button>
      </form>
    </div>
    <div class="bg-white/60 backdrop-blur-sm p-6 rounded-[70px_20px_70px_20px] reviews-card border border-[#F0F2F5]" id="reviewsList">
      <div class="text-center py-10">
        <div class="loading-spinner"></div>
        <p class="mt-4 text-gray-600">রিভিউ লোড হচ্ছে...</p>
      </div>
    </div>
  </div>
</section>

<footer class="footer-custom text-center py-5 footer-text mt-6">
  <div class="container-1200">
    <p class="text-[#E6EDF3]" id="footerText">AMAYRA · প্রিমিয়াম শার্ট কালেকশন · ২০২৫</p>
    <p class="text-[#E6EDF3] text-sm mt-2" id="footerSocial">ফেসবুক: @amayra.shirt | হটলাইন: 01712-345678</p>
  </div>
</footer>

<a href="#" target="_blank" class="whatsapp-float" id="whatsappButton" aria-label="WhatsApp">
  <i class="fab fa-whatsapp"></i>
</a>

<div class="fullscreen-modal" id="fullscreenModal">
  <span class="fullscreen-close" onclick="closeFullscreen()">&times;</span>
  <span class="fullscreen-prev" onclick="prevFullscreen()">&#10094;</span>
  <span class="fullscreen-next" onclick="nextFullscreen()">&#10095;</span>
  <img id="fullscreenImage" src="" alt="">
</div>

<script>
  const API_BASE = 'https://amayra-8hsr.onrender.com/api';
  
  let products = [];
  let categories = [];
  let sliders = [];
  let settings = {};
  let cart = [];
  let currentFilter = 'all';
  let currentSlide = 0;
  let slideInterval;
  let bestsellerProducts = [];
  let currentBestsellerIndex = 0;
  let bestsellerInterval;
  let currentProductImages = {};
  let fullscreenImages = [];
  let fullscreenCurrentIndex = 0;
  let lastAddedItemId = null;
  let allReviews = [];

  async function fetchWithRetry(url, options = {}, retries = 3, delay = 1000) {
    for (let i = 0; i < retries; i++) {
      try {
        const res = await fetch(url, options);
        if (!res.ok) {
          if (res.status === 429 && i < retries - 1) {
            const waitTime = delay * Math.pow(2, i);
            console.log(`Rate limited. Retrying in ${waitTime}ms...`);
            await new Promise(r => setTimeout(r, waitTime));
            continue;
          }
          throw new Error(`HTTP error ${res.status}`);
        }
        return res;
      } catch (err) {
        if (i === retries - 1) throw err;
        const waitTime = delay * Math.pow(2, i);
        console.log(`Request failed (${err.message}). Retrying in ${waitTime}ms...`);
        await new Promise(r => setTimeout(r, waitTime));
      }
    }
  }

  document.addEventListener('DOMContentLoaded', async function() {
    await loadSettings();
    await loadSliders();
    await loadCategories();
    await loadProducts();
    await loadReviews();
    await loadBestsellers();
    
    setupEventListeners();
    startSlideShow();

    // Add highlight style for order form
    addHighlightStyle();

    // Check URL hash on load and scroll to appropriate section/category/product
    checkHashAndScroll();
  });

  function addHighlightStyle() {
    const style = document.createElement('style');
    style.textContent = `
      #orderFormCard.highlight {
        animation: formHighlight 0.5s ease 2;
        border: 2px solid #FF7A00;
      }
      
      @keyframes formHighlight {
        0% { box-shadow: 0 0 0 0 rgba(255, 122, 0, 0.7); transform: scale(1); }
        50% { box-shadow: 0 0 30px 15px rgba(255, 122, 0, 0.4); transform: scale(1.02); }
        100% { box-shadow: 0 0 0 0 rgba(255, 122, 0, 0); transform: scale(1); }
      }

      .btn-cta:active {
        transform: scale(0.98);
      }
    `;
    document.head.appendChild(style);
  }

  function checkHashAndScroll() {
    const hash = window.location.hash;
    if (!hash) return;

    const categoryMatch = hash.match(/^#collection-(.+)$/);
    if (categoryMatch) {
      const category = categoryMatch[1];
      const categoryPill = document.querySelector(`a[href="#collection-${category}"]`);
      if (categoryPill) {
        setTimeout(() => {
          filterProducts(category, categoryPill);
          document.getElementById('collection').scrollIntoView({ behavior: 'smooth' });
        }, 500);
      }
      return;
    }

    const productMatch = hash.match(/^#product-(\d+)$/);
    if (productMatch) {
      const productId = parseInt(productMatch[1]);
      setTimeout(() => {
        addToCart(productId);
      }, 500);
      return;
    }

    const element = document.querySelector(hash);
    if (element) {
      setTimeout(() => {
        element.scrollIntoView({ behavior: 'smooth' });
      }, 100);
    }
  }

  window.addEventListener('hashchange', checkHashAndScroll);

  function updateSEOTags(settings) {
    if (!settings) return;
    
    const metaDescription = document.getElementById('metaDescription');
    if (metaDescription) {
      metaDescription.content = settings.metaDescription || 'প্রিমিয়াম কোয়ালিটির ফরমাল, ক্যাজুয়াল ও প্রিমিয়াম শার্ট সেরা দামে। AMAYRA তে অর্ডার করুন দ্রুত ডেলিভারি পাবেন।';
    }
    
    const metaKeywords = document.getElementById('metaKeywords');
    if (metaKeywords) {
      metaKeywords.content = settings.metaKeywords || 'শার্ট, ফরমাল শার্ট, ক্যাজুয়াল শার্ট, প্রিমিয়াম শার্ট, পাঞ্জাবি, ঢাকা, বাংলাদেশ, AMAYRA';
    }
    
    const metaAuthor = document.getElementById('metaAuthor');
    if (metaAuthor) {
      metaAuthor.content = settings.metaAuthor || 'AMAYRA';
    }
    
    const metaTitle = document.getElementById('metaTitle');
    if (metaTitle) {
      metaTitle.textContent = settings.metaTitle || 'AMAYRA · প্রিমিয়াম শার্ট কালেকশন';
    }
    
    const ogTitle = document.getElementById('ogTitle');
    if (ogTitle) {
      ogTitle.content = settings.ogTitle || 'AMAYRA · প্রিমিয়াম শার্ট কালেকশন';
    }
    
    const ogDescription = document.getElementById('ogDescription');
    if (ogDescription) {
      ogDescription.content = settings.ogDescription || 'প্রিমিয়াম কোয়ালিটির ফরমাল, ক্যাজুয়াল ও প্রিমিয়াম শার্ট সেরা দামে।';
    }
    
    const ogImage = document.getElementById('ogImage');
    if (ogImage) {
      ogImage.content = settings.ogImage || 'images/Amayra.jpg';
    }
  }

  async function loadSettings() {
    try {
      const res = await fetchWithRetry(`${API_BASE}/settings`);
      settings = await res.json();
      
      updateSEOTags(settings);
      
      document.getElementById('headerBrandName').textContent = settings.siteName || 'AMAYRA';
      document.getElementById('headerBrandSubtitle').textContent = 'PREMIUM SHIRT COLLECTION';
      document.getElementById('sidebarBrandName').textContent = settings.siteName || 'AMAYRA';
      document.getElementById('sidebarBrandSubtitle').textContent = 'PREMIUM SHIRT COLLECTION';
      
      const phoneNumber = settings.phoneNumber || '01712345678';
      document.getElementById('headerPhone').href = `tel:+88${phoneNumber}`;
      document.getElementById('sidebarPhone').href = `tel:+88${phoneNumber}`;
      
      const whatsappMessage = encodeURIComponent('হ্যালো, AMAYRA প্রিমিয়াম শার্ট কালেকশন সম্পর্কে জানতে চাই। আমি এই পণ্যটি সম্পর্কে আরও বিস্তারিত জানতে আগ্রহী।');
      document.getElementById('whatsappButton').href = `https://wa.me/${settings.whatsappNumber || '8801712345678'}?text=${whatsappMessage}`;
      
      document.getElementById('footerText').textContent = settings.footerText || 'AMAYRA · প্রিমিয়াম শার্ট কালেকশন · ২০২৫';
      document.getElementById('footerSocial').innerHTML = `ফেসবুক: ${settings.facebook || '@amayra.shirt'} | হটলাইন: ${settings.phoneNumber || '01712-345678'}`;
      
      document.getElementById('deliveryNote').innerHTML = `<i class="fa-solid fa-truck text-[#1877F2] mr-1"></i> ঢাকার মধ্যে ${settings.deliveryChargeDhaka || 60} টাকা, বাইরে ${settings.deliveryChargeOutside || 120} টাকা। ${settings.freeDeliveryThreshold || 2000} টাকার বেশি অর্ডারে ডেলিভারি ফ্রি!`;
      
    } catch (error) {
      console.error('Error loading settings:', error);
      settings = {
        siteName: 'AMAYRA',
        phoneNumber: '01712345678',
        whatsappNumber: '8801712345678',
        deliveryChargeDhaka: 60,
        deliveryChargeOutside: 120,
        freeDeliveryThreshold: 2000,
        footerText: 'AMAYRA · প্রিমিয়াম শার্ট কালেকশন · ২০২৫',
        facebook: '@amayra.shirt',
        metaDescription: 'প্রিমিয়াম কোয়ালিটির ফরমাল, ক্যাজুয়াল ও প্রিমিয়াম শার্ট সেরা দামে। AMAYRA তে অর্ডার করুন দ্রুত ডেলিভারি পাবেন।',
        metaKeywords: 'শার্ট, ফরমাল শার্ট, ক্যাজুয়াল শার্ট, প্রিমিয়াম শার্ট, পাঞ্জাবি, ঢাকা, বাংলাদেশ, AMAYRA',
        metaTitle: 'AMAYRA · প্রিমিয়াম শার্ট কালেকশন'
      };
      
      updateSEOTags(settings);
    }
  }

  async function loadSliders() {
    try {
      const res = await fetchWithRetry(`${API_BASE}/sliders`);
      sliders = await res.json();
      renderSliders();
    } catch (error) {
      console.error('Error loading sliders:', error);
      renderSliders();
    }
  }

function renderSliders() {
  const track = document.getElementById('sliderTrack');
  const dots = document.getElementById('sliderDots');
  
  if (!sliders || sliders.length === 0) {
    track.innerHTML = `
      <div class="w-full flex-shrink-0 slide-bg" style="background-image: url('https://images.unsplash.com/photo-1598033128083-2f68a5d9b1b1?w=1200&q=85');">
        <div class="w-full h-full flex items-center justify-start p-4 md:p-8">
          <div class="slide-content text-white">
            <span class="bg-[#1877F2] px-4 py-1.5 rounded-full text-sm inline-block mb-3">সীমিত অফার</span>
            <h2 class="text-3xl md:text-5xl font-bold mb-2">প্রিমিয়াম কালেকশন</h2>
            <p class="text-base md:text-lg mb-4 opacity-90">আড়ম্বরপূর্ণ ডিজাইন, অনন্য গুণগত মান</p>
            <button onclick="quickOrder(1)" class="btn-cta px-6 py-2.5 md:px-8 md:py-3 text-base md:text-lg">এখনই কিনুন</button>
          </div>
        </div>
      </div>
    `;
    dots.innerHTML = '<span class="w-2 h-2 rounded-full bg-[#1877F2] cursor-pointer" onclick="jumpToSlide(0)"></span>';
    return;
  }

  track.innerHTML = sliders.map((slider, index) => `
    <div class="w-full flex-shrink-0 slide-bg" style="background-image: url('${slider.imageUrl}');">
      <div class="w-full h-full flex items-center justify-start p-4 md:p-8">
        <div class="slide-content text-white">
          <span class="px-4 py-1.5 rounded-full text-sm inline-block mb-3" style="background: ${slider.badgeColor}">${slider.badge}</span>
          <h2 class="text-3xl md:text-5xl font-bold mb-2">${slider.title}</h2>
          <p class="text-base md:text-lg mb-4 opacity-90">${slider.subtitle}</p>
          <button onclick="quickOrder(${slider.productId})" class="btn-cta px-6 py-2.5 md:px-8 md:py-3 text-base md:text-lg">${slider.buttonText}</button>
        </div>
      </div>
    </div>
  `).join('');

  dots.innerHTML = sliders.map((_, index) => `
    <span class="w-2 h-2 rounded-full ${index === 0 ? 'bg-[#1877F2]' : 'bg-white/70'} cursor-pointer hover:scale-150 transition" onclick="jumpToSlide(${index})"></span>
  `).join('');
}
  async function loadCategories() {
    try {
      const res = await fetchWithRetry(`${API_BASE}/categories`);
      categories = await res.json();
    } catch (error) {
      console.error('Error loading categories:', error);
    }
  }

  async function loadProducts() {
    try {
      const res = await fetchWithRetry(`${API_BASE}/products`);
      products = await res.json();
      
      products.forEach(product => {
        currentProductImages[product.id] = 0;
      });
      
      renderProducts();
    } catch (error) {
      console.error('Error loading products:', error);
      document.getElementById('productGrid').innerHTML = `
        <div class="col-span-full text-center py-10">
          <p class="text-red-500 mb-4">প্রোডাক্ট লোড করতে ব্যর্থ হয়েছে</p>
          <button onclick="loadProducts()" class="btn-primary px-6 py-2">
            <i class="fas fa-sync-alt mr-2"></i>আবার চেষ্টা করুন
          </button>
        </div>
      `;
    }
  }

  function renderProducts() {
    const filtered = currentFilter === 'all' ? products : products.filter(p => p.category === currentFilter);
    
    if (!filtered.length) {
      document.getElementById('productGrid').innerHTML = '<div class="col-span-full text-center py-10 text-gray-500">কোন প্রোডাক্ট পাওয়া যায়নি</div>';
      return;
    }

    let html = '';
    filtered.forEach(product => {
      const discount = product.discountPercent || Math.round((1 - product.price / product.original) * 100);
      const isSoldOut = product.stock <= 0;
      const images = product.images && product.images.length ? product.images : [product.img];
      const currentIndex = currentProductImages[product.id] || 0;
      
      const productLink = `#product-${product.id}`;
      
      html += `
        <div class="product-tile p-4" id="product-${product.id}">
          <div class="product-gallery">
            <img src="${images[currentIndex]}" class="main-image" id="mainImg-${product.id}" onclick="openFullscreen('${product.id}')" onerror="this.src='https://via.placeholder.com/300x400?text=AMAYRA'">
            ${isSoldOut ? '<span class="sold-out">স্টক আউট</span>' : `<span class="absolute top-2 right-2 bg-[#FF7A00] text-white px-3 py-1 rounded-full text-xs">-${discount}%</span>`}
            
            <div class="thumbnail-container" id="thumbs-${product.id}">
              ${images.map((img, i) => `
                <img src="${img}" class="${i === currentIndex ? 'active' : ''}" onclick="changeProductImage(${product.id}, ${i}, event)" onerror="this.src='https://via.placeholder.com/60?text=IMG'">
              `).join('')}
            </div>
          </div>
          
          <div class="mt-2">
            <h4 class="font-bold text-lg text-[#1C1E21]">${product.name}</h4>
            <p class="text-sm text-[#1C1E21]/70">${product.desc}</p>
            <div class="flex justify-between mt-2">
              <span class="bg-[#F0F2F5] px-3 py-1 rounded-full text-xs text-[#1C1E21]">🧵 ${product.stock}</span>
              <span class="bg-[#F0F2F5] px-3 py-1 rounded-full text-xs text-[#1C1E21]">🔥 ${product.sold}</span>
            </div>
            <div class="flex justify-between items-center mt-4">
              <span>
                <span class="text-2xl font-bold text-[#FF7A00]">৳${product.price}</span>
                <span class="line-through text-[#1C1E21]/40 text-sm">৳${product.original}</span>
              </span>
              <a href="${productLink}" onclick="addToCart(${product.id}); return false;" class="btn-primary px-4 py-2 text-sm inline-block" ${isSoldOut ? 'style="opacity:0.5;pointer-events:none;"' : ''}>
                <i class="fa-solid fa-bag-shopping mr-1"></i> অর্ডার
              </a>
            </div>
          </div>
        </div>
      `;
    });

    document.getElementById('productGrid').innerHTML = html;
  }

  window.changeProductImage = (productId, index, event) => {
    event.stopPropagation();
    const product = products.find(p => p.id === productId);
    if (!product) return;
    
    const images = product.images && product.images.length ? product.images : [product.img];
    const mainImg = document.getElementById(`mainImg-${productId}`);
    if (mainImg && images[index]) {
      mainImg.src = images[index];
      currentProductImages[productId] = index;
      
      const thumbs = document.querySelectorAll(`#thumbs-${productId} img`);
      thumbs.forEach((thumb, i) => {
        if (i === index) {
          thumb.classList.add('active');
        } else {
          thumb.classList.remove('active');
        }
      });
    }
  };

  window.openFullscreen = (productId) => {
    const product = products.find(p => p.id === productId);
    if (!product) return;
    
    fullscreenImages = product.images && product.images.length ? product.images : [product.img];
    fullscreenCurrentIndex = currentProductImages[productId] || 0;
    
    const modal = document.getElementById('fullscreenModal');
    const img = document.getElementById('fullscreenImage');
    img.src = fullscreenImages[fullscreenCurrentIndex];
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
  };

  window.closeFullscreen = () => {
    document.getElementById('fullscreenModal').classList.remove('active');
    document.body.style.overflow = '';
  };

  window.prevFullscreen = () => {
    if (fullscreenImages.length <= 1) return;
    fullscreenCurrentIndex = (fullscreenCurrentIndex - 1 + fullscreenImages.length) % fullscreenImages.length;
    document.getElementById('fullscreenImage').src = fullscreenImages[fullscreenCurrentIndex];
  };

  window.nextFullscreen = () => {
    if (fullscreenImages.length <= 1) return;
    fullscreenCurrentIndex = (fullscreenCurrentIndex + 1) % fullscreenImages.length;
    document.getElementById('fullscreenImage').src = fullscreenImages[fullscreenCurrentIndex];
  };

  document.addEventListener('keydown', (e) => {
    if (!document.getElementById('fullscreenModal').classList.contains('active')) return;
    
    if (e.key === 'Escape') {
      closeFullscreen();
    } else if (e.key === 'ArrowLeft') {
      prevFullscreen();
    } else if (e.key === 'ArrowRight') {
      nextFullscreen();
    }
  });

  async function loadBestsellers() {
    try {
      const res = await fetchWithRetry(`${API_BASE}/products?sort=sold&limit=5`);
      bestsellerProducts = await res.json();
      
      if (bestsellerProducts.length === 0) {
        document.getElementById('bestsellerContainer').innerHTML = '<p class="text-center text-gray-500 py-4">কোন প্রোডাক্ট নেই</p>';
        return;
      }
      
      updateBestsellerDisplay();
      startBestsellerSlide();
      setTimeout(adjustHeights, 100);
    } catch (error) {
      console.error('Error loading bestsellers:', error);
      document.getElementById('bestsellerContainer').innerHTML = '<p class="text-center text-red-500 py-4">বেস্টসেলার লোড করতে ব্যর্থ</p>';
    }
  }

  function getRandomReviewsForProduct(productId, count = 2) {
    if (!allReviews || allReviews.length === 0) {
      return [
        {
          name: 'রহিম মিয়া',
          rating: 5,
          text: 'অসাধারণ কোয়ালিটি! ফেব্রিক খুব সফট।',
          address: 'ঢাকা'
        },
        {
          name: 'করিম হোসেন',
          rating: 4,
          text: 'ডিজাইন সুন্দর, দাম একটু বেশি কিন্তু মান ভালো।',
          address: 'চট্টগ্রাম'
        }
      ];
    }
    
    const productReviews = allReviews.filter(r => r.productId === productId);
    if (productReviews.length >= count) {
      return productReviews.slice(0, count);
    } else {
      const shuffled = [...allReviews].sort(() => 0.5 - Math.random());
      return shuffled.slice(0, count);
    }
  }

  function updateBestsellerDisplay() {
    if (bestsellerProducts.length === 0) return;
    
    const product = bestsellerProducts[currentBestsellerIndex];
    if (!product) return;
    
    const images = product.images && product.images.length ? product.images : [product.img];
    const discount = product.discountPercent || Math.round((1 - product.price / product.original) * 100);
    
    const reviews = getRandomReviewsForProduct(product.id, 2);
    
    const container = document.getElementById('bestsellerContainer');
    container.innerHTML = `
      <div class="bestseller-item">
        <div class="product-section">
          <img src="${images[0]}" class="w-24 h-24 object-cover rounded-[25px_6px_25px_6px]" onerror="this.src='https://via.placeholder.com/90'">
          <div class="bestseller-info">
            <h4>${product.name}</h4>
            <p class="text-sm text-gray-500 mb-1">${product.desc.substring(0, 40)}${product.desc.length > 40 ? '...' : ''}</p>
            <div class="bestseller-price">
              <span class="current">৳${product.price}</span>
              <span class="original">৳${product.original}</span>
            </div>
            <span class="bestseller-discount">-${discount}% ছাড়</span>
          </div>
        </div>
        
        <div class="bestseller-reviews">
          ${reviews.map((review, index) => `
            <div class="bestseller-review-item" style="animation-delay: ${index * 0.2}s">
              <div class="bestseller-review-header">
                <span class="bestseller-review-name">${review.name}</span>
                <span class="bestseller-review-rating">${'★'.repeat(review.rating)}${'☆'.repeat(5-review.rating)}</span>
              </div>
              <p class="bestseller-review-text">"${review.text}"</p>
              <div class="bestseller-review-location">
                <i class="fas fa-map-marker-alt"></i> ${review.address}
              </div>
            </div>
          `).join('')}
        </div>
        
        <a href="#product-${product.id}" onclick="addToCart(${product.id}); return false;" class="bestseller-btn" ${product.stock <= 0 ? 'style="opacity:0.5;pointer-events:none;"' : ''}>
          <i class="fa-solid fa-bag-shopping"></i>
          অর্ডার করুন
        </a>
      </div>
    `;

    const nav = document.getElementById('bestsellerNav');
    if (bestsellerProducts.length > 1) {
      nav.innerHTML = `
        <button onclick="changeBestseller(-1)"><i class="fas fa-chevron-left"></i></button>
        <span>${currentBestsellerIndex + 1}/${bestsellerProducts.length}</span>
        <button onclick="changeBestseller(1)"><i class="fas fa-chevron-right"></i></button>
      `;
    } else {
      nav.innerHTML = '';
    }
  }

  window.changeBestseller = (direction) => {
    if (bestsellerProducts.length <= 1) return;
    currentBestsellerIndex = (currentBestsellerIndex + direction + bestsellerProducts.length) % bestsellerProducts.length;
    updateBestsellerDisplay();
    restartBestsellerInterval();
  };

  function startBestsellerSlide() {
    if (bestsellerProducts.length <= 1) return;
    if (bestsellerInterval) clearInterval(bestsellerInterval);
    bestsellerInterval = setInterval(() => {
      changeBestseller(1);
    }, 6000);
  }

  function restartBestsellerInterval() {
    if (bestsellerInterval) clearInterval(bestsellerInterval);
    startBestsellerSlide();
  }

  function adjustHeights() {
    const orderForm = document.getElementById('orderFormCard');
    const bestseller = document.querySelector('.bestseller-slider');
    
    if (orderForm && bestseller && window.innerWidth >= 992) {
      const orderFormHeight = orderForm.offsetHeight;
      bestseller.style.minHeight = orderFormHeight + 'px';
    }
  }

  window.addEventListener('resize', function() {
    if (window.innerWidth >= 992) {
      adjustHeights();
    } else {
      const bestseller = document.querySelector('.bestseller-slider');
      if (bestseller) {
        bestseller.style.minHeight = '';
      }
    }
  });

  window.filterProducts = (category, element) => {
    document.querySelectorAll('.cat-pill').forEach(pill => {
      pill.classList.remove('active');
    });
    element.classList.add('active');
    currentFilter = category;
    renderProducts();
  };

  window.addToCart = (productId) => {
    const product = products.find(p => p.id === productId);
    if (!product || product.stock <= 0) {
      Swal.fire({
        icon: 'error',
        title: 'স্টক শেষ',
        text: 'এই প্রোডাক্টটি বর্তমানে স্টকে নেই',
        confirmButtonColor: '#1877F2',
        confirmButtonText: 'ঠিক আছে'
      });
      return;
    }

    document.getElementById('order').scrollIntoView({ behavior: 'smooth' });
    
    setTimeout(() => {
      const existingItem = cart.find(item => item.id === productId);
      const productImage = product.images && product.images.length ? product.images[0] : product.img;
      
      if (existingItem) {
        if (existingItem.quantity < product.stock) {
          existingItem.quantity++;
          lastAddedItemId = productId;
        } else {
          Swal.fire({
            icon: 'error',
            text: 'স্টক সীমা অতিক্রম করেছে',
            confirmButtonColor: '#1877F2',
            confirmButtonText: 'ঠিক আছে'
          });
          return;
        }
      } else {
        cart.push({
          id: product.id,
          name: product.name,
          price: product.price,
          quantity: 1,
          stock: product.stock,
          image: productImage
        });
        lastAddedItemId = productId;
      }
      
      updateCart();
      
      document.getElementById('orderFormCard').scrollIntoView({ behavior: 'smooth', block: 'center' });
      
      setTimeout(() => {
        const addedItem = document.querySelector(`.cart-item-new[data-product-id="${productId}"]`);
        if (addedItem) {
          addedItem.classList.add('highlight');
          setTimeout(() => {
            addedItem.classList.remove('highlight');
          }, 1000);
        }
      }, 100);
      
      Swal.fire({
        icon: 'success',
        title: 'কার্টে যুক্ত হয়েছে!',
        text: 'অর্ডার ফর্ম পূরণ করে অর্ডার সম্পন্ন করুন',
        toast: false,
        position: 'center',
        showConfirmButton: true,
        confirmButtonText: 'অর্ডার ফর্মে যান',
        confirmButtonColor: '#FF7A00',
        timer: 2000,
        timerProgressBar: true
      }).then((result) => {
        if (result.isConfirmed) {
          document.getElementById('order').scrollIntoView({ behavior: 'smooth' });
          document.getElementById('name').focus();
        }
      });

      history.pushState(null, null, `#product-${productId}`);
    }, 300);
  };

  window.quickOrder = async (productId) => {
    try {
      let product;
      
      if (products && products.length > 0) {
        product = products.find(p => p.id === productId);
      }
      
      if (!product) {
        const res = await fetchWithRetry(`${API_BASE}/products/${productId}`);
        product = await res.json();
      }
      
      if (!product) {
        Swal.fire({
          icon: 'error',
          title: 'প্রোডাক্ট পাওয়া যায়নি',
          text: 'এই প্রোডাক্টটি খুঁজে পাওয়া যায়নি',
          confirmButtonColor: '#1877F2',
          confirmButtonText: 'ঠিক আছে'
        });
        return;
      }

      if (product.stock <= 0) {
        Swal.fire({
          icon: 'error',
          title: 'স্টক শেষ',
          text: 'এই প্রোডাক্টটি বর্তমানে স্টকে নেই',
          confirmButtonColor: '#1877F2',
          confirmButtonText: 'ঠিক আছে'
        });
        return;
      }

      cart = [{
        id: product.id,
        name: product.name,
        price: product.price,
        quantity: 1,
        stock: product.stock,
        image: product.images && product.images.length ? product.images[0] : product.img
      }];
      
      updateCart();
      
      if (slideInterval) {
        clearInterval(slideInterval);
      }
      
      setTimeout(() => {
        document.getElementById('order').scrollIntoView({ 
          behavior: 'smooth',
          block: 'start'
        });
        
        const orderFormCard = document.getElementById('orderFormCard');
        if (orderFormCard) {
          orderFormCard.classList.add('highlight');
          setTimeout(() => {
            orderFormCard.classList.remove('highlight');
          }, 1500);
        }
        
        document.getElementById('name').focus();
      }, 100);
      
      Swal.fire({
        icon: 'success',
        title: 'প্রোডাক্ট যুক্ত হয়েছে!',
        text: 'অর্ডার ফর্ম পূরণ করে অর্ডার সম্পন্ন করুন',
        toast: false,
        position: 'center',
        showConfirmButton: true,
        confirmButtonText: 'অর্ডার সম্পন্ন করুন',
        confirmButtonColor: '#FF7A00',
        timer: 3000,
        timerProgressBar: true,
        didClose: () => {
          setTimeout(() => {
            document.getElementById('order').scrollIntoView({ behavior: 'smooth' });
          }, 100);
        }
      }).then((result) => {
        if (result.isConfirmed) {
          document.getElementById('order').scrollIntoView({ behavior: 'smooth' });
          document.getElementById('name').focus();
        }
      });

    } catch (error) {
      console.error('Error quick order:', error);
      Swal.fire({
        icon: 'error',
        title: 'ব্যর্থ হয়েছে',
        text: 'প্রোডাক্ট লোড করতে ব্যর্থ হয়েছে। দয়া করে আবার চেষ্টা করুন।',
        confirmButtonColor: '#1877F2',
        confirmButtonText: 'ঠিক আছে'
      });
    }
  };

  function updateCart() {
    const cartContainer = document.getElementById('cartItems');
    
    if (cart.length === 0) {
      cartContainer.innerHTML = '<p class="text-center p-4 text-[#1C1E21]">আপনার কার্ট খালি</p>';
      document.getElementById('subtotal').innerText = '৳0';
      document.getElementById('deliveryCharge').innerText = '৳0';
      document.getElementById('total').innerText = '৳0';
      return;
    }

    let subtotal = 0;
    let html = '';

    cart.forEach((item, index) => {
      subtotal += item.price * item.quantity;
      const product = products.find(p => p.id === item.id);
      const productImage = item.image || (product ? (product.images && product.images.length ? product.images[0] : product.img) : 'https://via.placeholder.com/50');
      
      html += `
        <div class="cart-item-new flex items-center gap-3" data-product-id="${item.id}">
          <img src="${productImage}" class="cart-item-image" onerror="this.src='https://via.placeholder.com/50'">
          <div class="flex-1">
            <span class="font-medium text-[#1C1E21] block">${item.name}</span>
            <span class="text-sm text-[#1C1E21]/70">৳${item.price} x ${item.quantity}</span>
          </div>
          <div class="flex gap-2 items-center">
            <button onclick="updateQuantity(${index}, -1)" class="bg-white w-8 h-8 rounded-[12px_2px_12px_2px] hover:bg-[#F0F2F5] transition text-[#1877F2]">
              <i class="fa-solid fa-minus"></i>
            </button>
            <span class="text-[#1C1E21]">${item.quantity}</span>
            <button onclick="updateQuantity(${index}, 1)" class="bg-white w-8 h-8 rounded-[12px_2px_12px_2px] hover:bg-[#F0F2F5] transition text-[#1877F2]">
              <i class="fa-solid fa-plus"></i>
            </button>
            <button onclick="removeFromCart(${index})" class="text-[#FF7A00] hover:text-[#e66e00] transition">
              <i class="fa-regular fa-trash-can"></i>
            </button>
          </div>
        </div>
      `;
    });

    cartContainer.innerHTML = html;

    const district = document.getElementById('district').value;
    const deliveryCharge = calculateDelivery(subtotal, district);
    const total = subtotal + deliveryCharge;

    document.getElementById('subtotal').innerText = `৳${subtotal}`;
    document.getElementById('deliveryCharge').innerText = `৳${deliveryCharge}`;
    document.getElementById('total').innerText = `৳${total}`;
  }

  function calculateDelivery(subtotal, district) {
    const freeThreshold = settings.freeDeliveryThreshold || 2000;
    const dhakaCharge = settings.deliveryChargeDhaka || 60;
    const outsideCharge = settings.deliveryChargeOutside || 120;

    if (subtotal >= freeThreshold) return 0;
    if (district === 'dhaka') return dhakaCharge;
    if (district === 'outside') return outsideCharge;
    return 0;
  }

  window.updateQuantity = (index, delta) => {
    const item = cart[index];
    const product = products.find(p => p.id === item.id);
    const newQuantity = item.quantity + delta;

    if (newQuantity < 1) return;
    
    if (newQuantity <= product.stock) {
      item.quantity = newQuantity;
      updateCart();
    } else {
      Swal.fire({
        icon: 'error',
        text: 'স্টক সীমা অতিক্রম করেছে',
        confirmButtonColor: '#1877F2',
        confirmButtonText: 'ঠিক আছে'
      });
    }
  };

  window.removeFromCart = (index) => {
    cart.splice(index, 1);
    updateCart();
  };

  document.getElementById('orderForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    if (cart.length === 0) {
      Swal.fire({
        icon: 'error',
        text: 'আপনার কার্ট খালি',
        confirmButtonColor: '#1877F2',
        confirmButtonText: 'ঠিক আছে'
      });
      return;
    }

    const phone = document.getElementById('phone').value;
    if (!/^01[3-9]\d{8}$/.test(phone)) {
      Swal.fire({
        icon: 'error',
        text: 'সঠিক মোবাইল নম্বর দিন',
        confirmButtonColor: '#1877F2',
        confirmButtonText: 'ঠিক আছে'
      });
      return;
    }

    const district = document.getElementById('district').value;
    if (!district) {
      Swal.fire({
        icon: 'error',
        text: 'জেলা নির্বাচন করুন',
        confirmButtonColor: '#1877F2',
        confirmButtonText: 'ঠিক আছে'
      });
      return;
    }

    const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    const deliveryCharge = calculateDelivery(subtotal, district);
    const total = subtotal + deliveryCharge;

    const orderData = {
      customerName: document.getElementById('name').value,
      phone: phone,
      district: district,
      address: document.getElementById('address').value,
      items: cart.map(item => ({
        id: item.id,
        name: item.name,
        price: item.price,
        quantity: item.quantity
      })),
      subtotal: subtotal,
      deliveryCharge: deliveryCharge,
      total: total
    };

    try {
      const res = await fetchWithRetry(`${API_BASE}/orders`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(orderData)
      }, 2);

      if (res.ok) {
        const data = await res.json();
        
        Swal.fire({
          icon: 'success',
          title: 'অর্ডার কনফার্ম হয়েছে!',
          html: `
            <div style="font-size:1.1rem; color:#1C1E21;">
              <p>অর্ডার আইডি: ${data.orderId}</p>
              <p>সাবটোটাল: ৳${subtotal}</p>
              <p>ডেলিভারি: ৳${deliveryCharge}</p>
              <p style="color:#FF7A00; font-weight:bold;">মোট: ৳${total}</p>
            </div>
            <p class="mt-3 text-[#1877F2] font-medium">আপনার সাথে খুব দ্রুতই যোগাযোগ করা হবে।</p>
          `,
          confirmButtonColor: '#1877F2',
          confirmButtonText: 'ঠিক আছে'
        });

        cart = [];
        updateCart();
        e.target.reset();

        await loadProducts();
      } else {
        throw new Error('Order failed');
      }
    } catch (error) {
      Swal.fire({
        icon: 'error',
        title: 'অর্ডার ব্যর্থ',
        text: 'দয়া করে আবার চেষ্টা করুন',
        confirmButtonColor: '#1877F2',
        confirmButtonText: 'ঠিক আছে'
      });
    }
  });

  async function loadReviews() {
    try {
      const res = await fetchWithRetry(`${API_BASE}/reviews`);
      allReviews = await res.json();
      displayReviews(allReviews);
    } catch (error) {
      console.error('Error loading reviews:', error);
      document.getElementById('reviewsList').innerHTML = `
        <div class="text-center py-10">
          <p class="text-red-500 mb-4">রিভিউ লোড করতে ব্যর্থ হয়েছে</p>
          <button onclick="loadReviews()" class="btn-primary px-6 py-2">
            <i class="fas fa-sync-alt mr-2"></i>আবার চেষ্টা করুন
          </button>
        </div>
      `;
    }
  }

  function displayReviews(reviews) {
    if (!reviews.length) {
      document.getElementById('reviewsList').innerHTML = '<p class="text-center p-4 text-gray-500">কোন রিভিউ পাওয়া যায়নি</p>';
      return;
    }

    const html = reviews.map(review => `
      <div class="bg-[#F0F2F5]/90 p-4 mb-3 rounded-[30px_6px_30px_6px]">
        <div class="flex justify-between items-center">
          <span class="font-bold text-[#1C1E21]">${review.name}</span>
          <span class="text-[#FF7A00]">${'★'.repeat(review.rating)}${'☆'.repeat(5-review.rating)}</span>
        </div>
        <p class="text-xs text-[#1877F2] mb-1">
          <i class="fas fa-map-marker-alt review-location-icon"></i> ${review.address}
        </p>
        <p class="text-[#1C1E21]">${review.text}</p>
      </div>
    `).join('');

    document.getElementById('reviewsList').innerHTML = html;
  }

  const starContainer = document.getElementById('starRating');
  const ratingInput = document.getElementById('rating');

  starContainer.querySelectorAll('i').forEach(star => {
    star.addEventListener('click', () => {
      const value = star.dataset.rate;
      ratingInput.value = value;
      
      starContainer.querySelectorAll('i').forEach((s, i) => {
        s.className = i < value ? 'fa-solid fa-star' : 'fa-regular fa-star';
      });
    });

    star.addEventListener('mouseenter', function() {
      const value = this.dataset.rate;
      starContainer.querySelectorAll('i').forEach((s, i) => {
        if (i < value) {
          s.classList.add('fa-solid');
          s.classList.remove('fa-regular');
        }
      });
    });

    star.addEventListener('mouseleave', function() {
      const currentRating = ratingInput.value;
      starContainer.querySelectorAll('i').forEach((s, i) => {
        s.className = i < currentRating ? 'fa-solid fa-star' : 'fa-regular fa-star';
      });
    });
  });

  document.getElementById('reviewForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const name = document.getElementById('reviewName').value;
    const address = document.getElementById('reviewAddress').value;
    const text = document.getElementById('reviewText').value;
    const rating = parseInt(ratingInput.value);

    if (!name || !address || !text || !rating) {
      Swal.fire({
        icon: 'error',
        text: 'সব তথ্য দিন',
        confirmButtonColor: '#1877F2',
        confirmButtonText: 'ঠিক আছে'
      });
      return;
    }

    try {
      const res = await fetchWithRetry(`${API_BASE}/reviews`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ name, address, text, rating })
      }, 2);

      if (res.ok) {
        Swal.fire({
          icon: 'success',
          title: 'রিভিউ জমা হয়েছে!',
          html: `
            <p style="font-size:1.1rem; color:#1C1E21;">আপনার মতামত আমাদের অনুপ্রেরণা!</p>
            <p class="mt-2 text-[#1877F2] font-medium">আপনার রেটিং: ${'★'.repeat(rating)}${'☆'.repeat(5-rating)}</p>
          `,
          confirmButtonColor: '#1877F2',
          confirmButtonText: 'ঠিক আছে'
        });

        e.target.reset();
        ratingInput.value = 0;
        starContainer.querySelectorAll('i').forEach(s => s.className = 'fa-regular fa-star');
        await loadReviews();
        updateBestsellerDisplay();
      } else {
        throw new Error('Review submission failed');
      }
    } catch (error) {
      Swal.fire({
        icon: 'error',
        text: 'রিভিউ জমা দিতে ব্যর্থ হয়েছে',
        confirmButtonColor: '#1877F2',
        confirmButtonText: 'ঠিক আছে'
      });
    }
  });

  document.getElementById('district').addEventListener('change', () => {
    updateCart();
  });

  function setupEventListeners() {
    const sidebar = document.getElementById('dropdownSidebar');
    const overlay = document.getElementById('dropdownOverlay');
    const hamburger = document.getElementById('hamburgerBtn');
    const closeBtn = document.getElementById('closeMenuBtn');
    const menuLinks = document.querySelectorAll('.menu-link');

    function openMenu() {
      sidebar.classList.add('open');
      overlay.classList.add('open');
      hamburger.classList.add('open');
      document.body.classList.add('menu-open');
    }

    function closeMenu() {
      sidebar.classList.remove('open');
      overlay.classList.remove('open');
      hamburger.classList.remove('open');
      document.body.classList.remove('menu-open');
    }

    hamburger.addEventListener('click', (e) => {
      e.stopPropagation();
      if (sidebar.classList.contains('open')) {
        closeMenu();
      } else {
        openMenu();
      }
    });

    closeBtn.addEventListener('click', closeMenu);
    overlay.addEventListener('click', closeMenu);
    
    menuLinks.forEach(link => {
      link.addEventListener('click', closeMenu);
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && sidebar.classList.contains('open')) {
        closeMenu();
      }
    });

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        const href = this.getAttribute('href');
        if (href === '#') return;
        
        const target = document.querySelector(href);
        if (target && !href.includes('product-') && !href.includes('collection-')) {
          e.preventDefault();
          target.scrollIntoView({ behavior: 'smooth' });
        }
      });
    });
  }

  window.slideChange = (direction) => {
    if (!sliders || !sliders.length) return;
    
    const track = document.getElementById('sliderTrack');
    const totalSlides = sliders.length;
    currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
    track.style.transform = `translateX(-${currentSlide * 100}%)`;
    updateSliderDots();
  };

  window.jumpToSlide = (index) => {
    if (!sliders || !sliders.length) return;
    
    currentSlide = index;
    document.getElementById('sliderTrack').style.transform = `translateX(-${index * 100}%)`;
    updateSliderDots();
  };

  function updateSliderDots() {
    const dots = document.querySelectorAll('.hero-slide .rounded-full');
    dots.forEach((dot, i) => {
      dot.style.background = i === currentSlide ? '#1877F2' : 'rgba(255,255,255,0.7)';
    });
  }

  function startSlideShow() {
    if (slideInterval) clearInterval(slideInterval);
    slideInterval = setInterval(() => {
      slideChange(1);
    }, 5000);
  }

  document.querySelector('.hero-slide')?.addEventListener('mouseenter', () => {
    clearInterval(slideInterval);
  });

  document.querySelector('.hero-slide')?.addEventListener('mouseleave', () => {
    startSlideShow();
  });
</script>
</body>
</html>